---
title: æ‰“å°å›¾åƒ
date: 2021-07-02 14:31:37
permalink: /pages/b21343/
categories:
  - demo
---

å¦‚ä½•æ‰“å°å›¾åƒï¼Ÿ

é€šè¿‡å•å‡»æµè§ˆå™¨çš„æ‰“å°èœå•æˆ–è€…ä½¿ç”¨å¿«æ·é”® `Ctrl + p` æ¥æ‰“å°ã€‚æˆ–è€…ä½¿ç”¨ ` window.print()` å‡½æ•°æ‰“å°æ•´ä¸ªé¡µé¢ã€‚

ä¸ºäº†æ‰“å°å›¾åƒï¼Œå¯ä»¥å°†å›¾åƒå…ƒç´ æ’å…¥åˆ°ä¸€ä¸ªä¼ª `iframe` å…ƒç´ ä¸­ï¼Œåœ¨iframeçš„çª—å£ä¸­è°ƒç”¨`print()` å‡½æ•°æ‰“å°ã€‚ğŸ”½

```js
<img src="https://xxx.xx.com" alt="" id="image">
<button id="print">Print</button>
```
è·å–æ‰“å°æŒ‰é’®ï¼Œç›‘å¬ `click` äº‹ä»¶

```js
const printBtn = document.getElementById('print');

printBtn.addEventListener('click', function(){
  Â·Â·Â·Â·
})
```
### åˆ›å»º iframe
```js
const iframe = document.createElement('iframe')

// éšè— make it hidden
iframe.style.height = 0
iframe.style.visibility = 'hidden'
iframe.style.width = 0

// æ·»åŠ å†…å®¹
iframe.setAttribute('srcdoc','<html><body></body></html>')

document.body.appendChild(iframe)
```
> srcdoc ä¸€ä¸ªDOMStringï¼Œè¡¨ç¤ºè¯¥æ¡†æ¶ä¸­è¦æ˜¾ç¤ºçš„å†…å®¹ å‚è€ƒé“¾æ¥ï¼š[srcdoc](https://developer.mozilla.org/en-US/docs/Web/API/HTMLIFrameElement/srcdoc)
### demo æµ‹è¯•

### å½“ iframe åŠ è½½å®Œæˆåæ’å…¥å›¾ç‰‡

```js
iframe.addEventListener('load', function() {
 // æ‹·è´å›¾åƒ  Clone the image
 const image = document.getElementById('image').cloneNode();
 image.style.maxWidth = '100%';

 // æ’å…¥å›¾åƒ Append the image to the iframe's body
 const body = iframe.contentDocument.body;
 body.style.textAlign = 'center';
 body.appendChild(image);

 // å›¾ç‰‡åŠ è½½å®Œæˆåè°ƒç”¨ iframe ä¸Šçš„æ‰“å°
 image.addEventListener('load',function () {
   iframe.contentWindow.print()
 })
})
```
### ç§»é™¤ iframe
```js
iframe.contentWindow.addEventListener('afterprint',function() {
  console.log('---æ‰“å°çª—å£å…³é—­---')
  iframe.parentNode.removeChild(iframe)
})
```
:::demo [vanilla]

```html
<html>
  <body>
    <div
      style="display: flex; flex-direction: column; justify-content: center; padding: 4rem;"
    >
      <img id="image" src="https://avatars.githubusercontent.com/u/37177191?v=4"  style="width: 120px; height: 120px; margin: 0 auto;"/>
      <div style="margin-top: 1rem; text-align: center;">
        <button
          style="background-color: #63b3ed; border: none; color: #fff; cursor: pointer; padding: .5rem 1rem;"
          id="print"
        >
          Print
        </button>
      </div>
    </div>
    <script>
      // Query the element
      const printBtn = document.getElementById("print");

      printBtn.addEventListener("click", function() {
        // Create a fake iframe
        const iframe = document.createElement("iframe");

        // Make it hidden
        iframe.style.height = 0;
        iframe.style.visibility = "hidden";
        iframe.style.width = 0;

        // Set the iframe's source
        iframe.setAttribute("srcdoc", "<html><body></body></html>");

        document.body.appendChild(iframe);

        iframe.contentWindow.addEventListener("afterprint", function() {
          console.log('---æ‰“å°çª—å£å…³é—­---')
          iframe.parentNode.removeChild(iframe);
        });

        iframe.addEventListener("load", function() {
          // Clone the image
          const image = document.getElementById("image").cloneNode();
          image.style.maxWidth = "100%";

          // Append the image to the iframe's body
          const body = iframe.contentDocument.body;
          body.style.textAlign = "center";
          body.appendChild(image);

          image.addEventListener("load", function() {
            // Invoke the print when the image is ready
            iframe.contentWindow.print();
          });
        });
      });
    </script>
  </body>
</html>
```

:::
